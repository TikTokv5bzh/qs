<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لعبة حروف</title>
    <style>
        /* CSS Styles */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            direction: rtl; /* For Arabic language */
        }

        h1 {
            color: #333;
        }

        #game-container {
            display: flex;
            gap: 20px;
            align-items: flex-start; /* Align items to the top */
        }

        #crossword-grid {
            display: grid;
            /* Will be populated by JavaScript based on puzzle size */
            /* Example: grid-template-columns: repeat(10, 30px); */
            border: 2px solid #333;
            background-color: #fff;
            margin-bottom: 20px;
        }

        .grid-cell {
            width: 35px; /* Cell width for PC */
            height: 35px; /* Cell height for PC */
            border: 1px solid #ccc;
            text-align: center;
            font-size: 18px; /* Font size for PC */
            line-height: 35px; /* Vertically center text */
            box-sizing: border-box; /* Include padding and border in the element's total width and height */
            background-color: white; /* Default empty cell */
            position: relative; /* For numbering */
        }

        .grid-cell.black {
            background-color: black;
        }

        .grid-cell input {
            width: 100%;
            height: 100%;
            border: none;
            text-align: center;
            font-size: inherit; /* Inherit font size from parent */
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            outline: none; /* Remove focus outline */
            background-color: transparent; /* Make input transparent over cell */
        }

        .cell-number {
            position: absolute;
            top: 1px;
            left: 1px;
            font-size: 9px;
            color: #555;
            line-height: 1;
        }

        #clues-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 300px; /* Width for clues section on PC */
        }

        .clue-section {
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .clue-section h2 {
            margin-top: 0;
            font-size: 1.2em;
            color: #555;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }

        .clue-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .clue-list li {
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        #controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        #controls button {
            padding: 10px 15px;
            font-size: 1em;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #controls button:hover {
            background-color: #0056b3;
        }

    </style>
</head>
<body>
    <h1>لعبة الكلمات المتقاطعة</h1>

    <div id="game-container">
        <div id="crossword-grid-container">
            <div id="crossword-grid">
                </div>
        </div>

        <div id="clues-container">
            <div class="clue-section">
                <h2>الأفقي:</h2>
                <ul id="across-clues" class="clue-list">
                    </ul>
            </div>
            <div class="clue-section">
                <h2>العمودي:</h2>
                <ul id="down-clues" class="clue-list">
                    </ul>
            </div>
        </div>
    </div>

    <div id="controls">
        <button id="check-button">تحقق من الإجابات</button>
        <button id="reveal-letter-button">كشف حرف</button>
        <button id="reveal-word-button">كشف كلمة</button>
        <button id="reset-button">إعادة تعيين</button>
    </div>

    <script>
        // JavaScript Code
        document.addEventListener('DOMContentLoaded', function() {
            const gridContainer = document.getElementById('crossword-grid');
            const acrossCluesList = document.getElementById('across-clues');
            const downCluesList = document.getElementById('down-clues');

            // تعريف بسيط للغز (كمثال)
            // 1 = خلية سوداء, 0 = خلية بيضاء قابلة للكتابة
            const puzzleLayout = [
                [0, 0, 0, 1, 0],
                [0, 1, 0, 1, 0],
                [0, 0, 0, 0, 0],
                [0, 1, 0, 1, 0],
                [0, 0, 0, 1, 0]
            ];

            const puzzleData = {
                across: [
                    { number: 1, clue: "عاصمة فرنسا", answer: "باريس", row: 0, col: 0, length: 3 },
                    { number: 3, clue: "حيوان أليف", answer: "قطة", row: 2, col: 0, length: 3},
                    { number: 4, clue: "عكس كلمة 'تحت'", answer: "فوق", row: 4, col: 0, length: 3}

                ],
                down: [
                    { number: 1, clue: "عاصمة مصر", answer: "قاهرة", row: 0, col: 0, length: 5 },
                    { number: 2, clue: "لون السماء", answer: "ازرق", row: 0, col: 2, length: 5 }
                ]
            };


            const rows = puzzleLayout.length;
            const cols = puzzleLayout[0].length;
            gridContainer.style.gridTemplateColumns = `repeat(${cols}, 35px)`;

            let cellNumber = 1;
            const numberedCells = {}; // لتخزين بداية الكلمات المرقمة

            // إنشاء الشبكة والخلايا المرقمة
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    const cell = document.createElement('div');
                    cell.classList.add('grid-cell');
                    cell.dataset.row = r;
                    cell.dataset.col = c;

                    if (puzzleLayout[r][c] === 1) {
                        cell.classList.add('black');
                    } else {
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.maxLength = 1;
                        input.dataset.row = r;
                        input.dataset.col = c;
                        // تحريك التركيز إلى الخلية التالية عند الكتابة
                        input.addEventListener('input', (e) => {
                            if (e.target.value.length === 1) {
                                const nextInput = findNextInput(e.target);
                                if (nextInput) nextInput.focus();
                            }
                        });
                        input.addEventListener('keydown', (e) => handleKeyDown(e, input));

                        cell.appendChild(input);

                        // ترقيم الخلايا لبداية الكلمات
                        let isAcrossStart = (c === 0 || (puzzleLayout[r][c-1] === 1)) && (c + 1 < cols && puzzleLayout[r][c+1] === 0);
                        let isDownStart = (r === 0 || (puzzleLayout[r-1][c] === 1)) && (r + 1 < rows && puzzleLayout[r+1][c] === 0);

                        if(isAcrossStart || isDownStart) {
                            const numberSpan = document.createElement('span');
                            numberSpan.classList.add('cell-number');
                            numberSpan.textContent = cellNumber;
                            cell.appendChild(numberSpan);
                            numberedCells[`${r}-${c}`] = cellNumber;
                            cellNumber++;
                        }
                    }
                    gridContainer.appendChild(cell);
                }
            }

            // إضافة الأسئلة
            puzzleData.across.forEach(clue => {
                const listItem = document.createElement('li');
                // العثور على الرقم الصحيح للخلية
                const cellKey = `${clue.row}-${clue.col}`;
                const displayNum = numberedCells[cellKey] || clue.number; // استخدام رقم السؤال إذا لم يكن مرقماً تلقائياً

                listItem.textContent = `${displayNum}. ${clue.clue} (${clue.answer.length} حروف)`;
                listItem.dataset.answer = clue.answer;
                listItem.dataset.row = clue.row;
                listItem.dataset.col = clue.col;
                listItem.dataset.direction = 'across';
                acrossCluesList.appendChild(listItem);
            });

            puzzleData.down.forEach(clue => {
                const listItem = document.createElement('li');
                const cellKey = `${clue.row}-${clue.col}`;
                const displayNum = numberedCells[cellKey] || clue.number;

                listItem.textContent = `${displayNum}. ${clue.clue} (${clue.answer.length} حروف)`;
                listItem.dataset.answer = clue.answer;
                listItem.dataset.row = clue.row;
                listItem.dataset.col = clue.col;
                listItem.dataset.direction = 'down';
                downCluesList.appendChild(listItem);
            });

            // وظائف الأزرار (تحتاج إلى تفصيل أكثر)
            document.getElementById('check-button').addEventListener('click', checkAnswers);
            document.getElementById('reveal-letter-button').addEventListener('click', () => revealHint('letter'));
            document.getElementById('reveal-word-button').addEventListener('click', () => revealHint('word'));
            document.getElementById('reset-button').addEventListener('click', resetGrid);

            function findNextInput(currentInput) {
                // هذه دالة بسيطة، يمكن تحسينها لتتبع اتجاه الكتابة (أفقي/عمودي)
                const allInputs = Array.from(gridContainer.querySelectorAll('input'));
                const currentIndex = allInputs.indexOf(currentInput);
                if (currentIndex !== -1 && currentIndex + 1 < allInputs.length) {
                    return allInputs[currentIndex + 1];
                }
                return null;
            }

            function handleKeyDown(event, inputElement) {
                const row = parseInt(inputElement.dataset.row);
                const col = parseInt(inputElement.dataset.col);
                let nextRow = row;
                let nextCol = col;

                switch (event.key) {
                    case 'ArrowUp':
                        nextRow = Math.max(0, row - 1);
                        event.preventDefault();
                        break;
                    case 'ArrowDown':
                        nextRow = Math.min(rows - 1, row + 1);
                        event.preventDefault();
                        break;
                    case 'ArrowLeft':
                        nextCol = Math.max(0, col - 1);
                        event.preventDefault();
                        break;
                    case 'ArrowRight':
                        nextCol = Math.min(cols - 1, col + 1);
                        event.preventDefault();
                        break;
                    case 'Backspace':
                        if (inputElement.value === '') {
                            const prevInput = findPrevInput(inputElement);
                            if (prevInput) {
                                prevInput.focus();
                                prevInput.value = ''; // مسح قيمة الخلية السابقة أيضًا عند الرجوع
                            }
                            event.preventDefault();
                        }
                        return; // لا تنقل التركيز تلقائيًا عند المسح داخل الخلية
                    default:
                        return; // لا تفعل شيئًا للمفاتيح الأخرى
                }

                const nextCell = gridContainer.querySelector(`input[data-row='${nextRow}'][data-col='${nextCol}']`);
                if (nextCell && !nextCell.parentElement.classList.contains('black')) {
                    nextCell.focus();
                }
            }
             function findPrevInput(currentInput) {
                const allInputs = Array.from(gridContainer.querySelectorAll('input:not([disabled]))')); // تجاهل الخلايا المعطلة
                const currentIndex = allInputs.indexOf(currentInput);
                if (currentIndex > 0) {
                    return allInputs[currentIndex - 1];
                }
                return null;
            }


            function checkAnswers() {
                console.log("التحقق من الإجابات...");
                let allCorrect = true;

                puzzleData.across.forEach(clue => {
                    let userAnswer = "";
                    for (let i = 0; i < clue.length; i++) {
                        const cellInput = gridContainer.querySelector(`input[data-row='${clue.row}'][data-col='${clue.col + i}']`);
                        if (cellInput) {
                            userAnswer += cellInput.value.toUpperCase(); // توحيد حالة الأحرف للمقارنة
                        }
                    }
                    if (userAnswer.toLowerCase() === clue.answer.toLowerCase()) {
                        // يمكنك إضافة تنسيق للإجابة الصحيحة هنا
                        console.log(`Across Clue ${clue.number} (${clue.answer}): Correct!`);
                         for (let i = 0; i < clue.length; i++) {
                            const cellInput = gridContainer.querySelector(`input[data-row='${clue.row}'][data-col='${clue.col + i}']`);
                            if(cellInput) cellInput.style.backgroundColor = '#d4edda'; // أخضر فاتح
                        }
                    } else {
                        allCorrect = false;
                        console.log(`Across Clue ${clue.number} (${clue.answer}): Incorrect. You entered: ${userAnswer}`);
                         for (let i = 0; i < clue.length; i++) {
                            const cellInput = gridContainer.querySelector(`input[data-row='${clue.row}'][data-col='${clue.col + i}']`);
                             if(cellInput && cellInput.value !== '') cellInput.style.backgroundColor = '#f8d7da'; // أحمر فاتح
                        }
                    }
                });

                puzzleData.down.forEach(clue => {
                    let userAnswer = "";
                    for (let i = 0; i < clue.length; i++) {
                        const cellInput = gridContainer.querySelector(`input[data-row='${clue.row + i}'][data-col='${clue.col}']`);
                        if (cellInput) {
                            userAnswer += cellInput.value.toUpperCase();
                        }
                    }
                     if (userAnswer.toLowerCase() === clue.answer.toLowerCase()) {
                        console.log(`Down Clue ${clue.number} (${clue.answer}): Correct!`);
                        for (let i = 0; i < clue.length; i++) {
                            const cellInput = gridContainer.querySelector(`input[data-row='${clue.row + i}'][data-col='${clue.col}']`);
                             if(cellInput) cellInput.style.backgroundColor = '#d4edda';
                        }
                    } else {
                        allCorrect = false;
                        console.log(`Down Clue ${clue.number} (${clue.answer}): Incorrect. You entered: ${userAnswer}`);
                        for (let i = 0; i < clue.length; i++) {
                            const cellInput = gridContainer.querySelector(`input[data-row='${clue.row + i}'][data-col='${clue.col}']`);
                            if(cellInput && cellInput.value !== '') cellInput.style.backgroundColor = '#f8d7da';
                        }
                    }
                });

                if(allCorrect) {
                    alert("رائع! لقد أجبت على جميع الأسئلة بشكل صحيح!");
                } else {
                    alert("بعض الإجابات غير صحيحة. حاول مرة أخرى!");
                }
            }

            function revealHint(type) {
                // هذه وظيفة مبسطة لكشف الحرف/الكلمة (تحتاج إلى اختيار السؤال أولاً)
                alert(`وظيفة "${type === 'letter' ? 'كشف حرف' : 'كشف كلمة'}" لم تبرمج بالكامل بعد.`);
                // كمثال: يمكن أن تختار أول كلمة خاطئة أو سؤال محدد من قبل المستخدم
                // وتكشف حرفًا منها أو الكلمة بأكملها.
            }

            function resetGrid() {
                console.log("إعادة تعيين اللوحة...");
                const inputs = gridContainer.querySelectorAll('input');
                inputs.forEach(input => {
                    input.value = '';
                    input.style.backgroundColor = 'transparent'; // إعادة لون الخلفية
                    input.disabled = false; // تفعيل الإدخال إذا كان معطلاً
                });
                // إعادة ضبط ألوان الأسئلة إذا تم تغييرها
                document.querySelectorAll('#across-clues li, #down-clues li').forEach(li => {
                    li.style.textDecoration = 'none';
                    li.style.color = 'inherit';
                });
                alert("تم إعادة تعيين اللوحة.");
            }
        });
    </script>
</body>
</html>
